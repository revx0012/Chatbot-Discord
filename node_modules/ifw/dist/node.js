"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const { fetch, setGlobalDispatcher, ProxyAgent } = require('undici');
const { HttpsProxyAgent } = require('https-proxy-agent');
const ws = require('ws');
const { Blob } = require('node:buffer');
const httpProxy = process.env.http_proxy || process.env.HTTP_PROXY || process.env.https_proxy || process.env.HTTPS_PROXY;
let WebSocket = ws.WebSocket;
if (httpProxy) {
    setGlobalDispatcher(new ProxyAgent(httpProxy));
    const agent = new HttpsProxyAgent(httpProxy);
    // @ts-ignore
    WebSocket = class extends ws.WebSocket {
        constructor(address, options) {
            super(address, {
                ...options,
                agent,
            });
        }
    };
}
exports.default = { fetch, WebSocket, Blob };
